!function(){for(var a,t=$(".Cards"),e=t.children(".Card"),d=[$(e)],n=0;n<3;n++)a=e.clone(),a.find(".TabHead, .TabItem").each(function(){this.dataset.tab="SKill"+(n+2)}),t.append(a),d.push($(a));window.cards=d}(),function(){window.kqd={page:0,pageMax:0,xhrUnlock:!0,dynmSearch:!0},window.kqe={toggles:$(".Toggle[data-x]"),rightNavi:$(".TabHead.RightNavi[data-tab=RightNavi]"),condName:$("#CondName"),search:$("#Search"),pagePrev:$(".PagePrev"),pageNext:$(".PageNext"),tips:$(".Tips")},window.kqs={page:$(".sPage"),pageMax:$(".sPageMax")},kqs.cards=window.cards,delete window.cards,window.kqf={retab:function(){$(".TabHead[data-tab]").unbind("click").click(function(){if(""==this.dataset.stop)return!1;var a,t,e=this.dataset.tab,d=this.dataset.page,n=this.dataset.func;return!!e&&(a=$(".TabHead[data-tab="+e+"]"),t=$(".TabItem[data-tab="+e+"]"),d&&(a.filter(":not([data-page="+d+"])").removeClass("active"),$(this).addClass("active"),t.filter(":not([data-page="+d+"])").addClass("hide"),t.filter("[data-page="+d+"]").removeClass("hide")),void(n&&(a.filter(":not([data-func="+n+"])").removeClass("active"),$(this).addClass("active"),kqf["tab"+e](n))))})},dealer:function(a){var t,e=a[0],d=kqs.cards;kqs.page.html(kqd.page=~~a[1]),kqs.pageMax.html(kqd.pageMax=~~a[2]);for(t in d)d[t].addClass("hide");for(t in e){var n=d[t],s=e[t];n[0].dataset.id=s.id,n.find(".sTitle").html("&lt;"+s.title+"&gt;"+s.name),n.find(".sCost").html(s.cost),n.find(".sStar").html(s.star||""),n.find(".sJob").html(s.job),n.find(".sAttr").html(s.attr),n.find(".sKind").html(s.kind),n.find(".sRare").html(s.rare),n.find(".sHP").html(s.hp),n.find(".sAD").html(s.ad),n.find(".sAP").html(s.ap),n.find(".sHQ").html(s.hq),n.find(".sThumb").attr("src",""),n.find(".sThumb").attr("src","https://raw.githubusercontent.com/kairiquery/kqp"+kq.conds.serv+"21/master/"+s.id+".png");var i=["awaken","normal","suport3"];for(var r in i){var l=i[r],o=s.skill[l]||[],c=0,k=n.find(".TabItem.Skill[data-page="+l+"]"),f=k.find(".TabHeader.SkillContent").empty(),p=k.find(".TabBox.SkillContent").empty();o.length||o.push({cond:"&nbsp;",content:"无"});for(var h in o){var m=o[h],g=$("<a><div></div></a>").addClass("flex jcc aic TabHead SkillContent").appendTo(f);g[0].dataset.tab="Skill"+t+l,g[0].dataset.page=c,g.find("div").html(m.cond||"无"),"无"==g.html()&&h>0&&g.css("width","20%");var v='<span class="bfrTextRoles"></span>';for(var b in m.content)v+='<span class="TextRole">'+(m.content[b]||"无")+"</span>";v+='<span class="bfrTextRoles"></span>';var q=$("<div>").addClass("TabItem SkillContent").html(v).appendTo(p);q[0].dataset.tab="Skill"+t+l,q[0].dataset.page=c++}f.find(">:last-child").addClass("active")}var u=kq.conds.mark[0][7]?2:"通用"!=s.job?0:1;n.find(".TabHead.Skill").removeClass("primary").filter("[data-page="+i[u]+"]").addClass("primary"),n.removeClass("hide")}kqf.retab(),$(".TabHead.Skill.primary").click(),$(".TabHeader.SkillContent>.active").click()},tabServ:function(a){kq.conds.serv=a,kqe.search.click()}}}(),function(){window.kq={conds:{serv:"cn",name:"",mark:[[]]},param:function(a){var t=$.extend({},kq.conds,{page:kqd.page,mark:kq.conds.mark.toString().replace(/\,/g,"~"),zero:/[1-9]/.test(kq.conds.mark.toString())?0:1});return a&&a(t),t},query:function(a,t,e,d){if(kqd.xhrUnlock)return kqd.xhrUnlock=!1,$.get({url:"kq/q",data:kq.param(a),success:t}).fail(e).always(function(){kqd.xhrUnlock=!0,d&&d()})}}}();!function(){$(window).resize(function(){$(".Main").width(document.body.clientWidth-450)}),$(".Main").width(document.body.clientWidth-450)}(),function(){kqe.toggles.click(function(e,a){var t=$(this),n=this.dataset.cond,d=this.dataset.x,c=this.dataset.y,i=this.dataset.z,o=t.hasClass("all");a&&(o=!0),"s"==d?(kqd.dynmSearch=!1,kqe.toggles.filter("[data-cond="+n+"]:not([data-x=s])").each(function(){$(this).addClass(o?"on":"off").removeClass(o?"off":"on").click()}),a||(kqd.dynmSearch=!0),t.toggleClass("all"),a||kq.query(function(e){e.page=1},kqf.dealer)):(e.ctrlKey&&!e.shiftKey?(kqd.dynmSearch=!1,kqe.toggles.filter("[data-cond="+n+"]:not([data-x="+d+"][data-y="+c+"][data-z="+i+"]):not([data-x=s])").each(function(){$(this).addClass("on").removeClass("off").click()}),a||(kqd.dynmSearch=!0),t.removeClass("on").addClass("off").click()):!e.ctrlKey&&e.shiftKey?(kqd.dynmSearch=!1,kqe.toggles.filter("[data-cond="+n+"]:not([data-x="+d+"][data-y="+c+"][data-z="+i+"]):not([data-x=s])").each(function(){$(this).addClass("off").removeClass("on").click()}),a||(kqd.dynmSearch=!0),t.removeClass("off").addClass("on").click()):(kqe.toggles.filter("[data-cond="+n+"][data-x="+d+"][data-y="+c+"][data-z="+i+"]").toggleClass("on").toggleClass("off"),n&&d&&c&&i&&(t.hasClass("on")?kq.conds.mark[d][c]|=i:kq.conds.mark[d][c]&=~i,kqd.dynmSearch&&kq.query(function(e){e.page=1},kqf.dealer))),a&&(kqd.dynmSearch=!0))})}(),function(){$(document).keydown(function(e){var a=document.activeElement;if("input"==a.type||"textarea"==a.type)return"condName"!=a.id||13!=e.keyCode||(e.shiftKey&&$("[data-cond][data-x=s]").trigger("click",{fourceON:!0}),kqe.search.click(),!1);if(a==$(".sPage")[0]){if(13==e.keyCode){var t=$(e.target),n=t.html();return n>0&&n<=kqd.pageMax?kq.query(function(e){e.page=n},kqf.dealer):t.html(kqd.page),!1}}else{if(9==e.keyCode){for(var d=kqe.rightNavi.filter(".active"),c=!0;c;)d=d[e.shiftKey?"prev":"next"](),d.length||(d=kqe.rightNavi[e.shiftKey?"last":"first"]()),""!==d[0].dataset.notab&&(c=!1);return d.click(),!1}if(33==e.keyCode||74==e.keyCode)return kqe.pagePrev.click(),!1;if(34==e.keyCode||75==e.keyCode)return kqe.pageNext.click(),!1;if(35==e.keyCode||78==e.keyCode)return kq.query(function(e){e.page=kqd.pageMax},kqf.dealer),!1;if(36==e.keyCode||77==e.keyCode)return kq.query(function(e){e.page=1},kqf.dealer),!1;if(81==e.keyCode&&e.ctrlKey)return kqe.condName.focus(),!1;if(13==e.keyCode&&e.shiftKey)return $("[data-cond][data-x=s]").trigger("click",{}),kqe.search.click(),!1}})}(),function(){kqe.search.click(function(){kqd.dynmSearch=!0,kq.conds.name=kqe.condName.val(),kq.query(function(e){e.page=1},kqf.dealer)}),kqe.pagePrev.click(function(){kqd.page>1&&kq.query(function(e){e.page--},kqf.dealer)}),kqe.pageNext.click(function(){kqd.page<kqd.pageMax&&kq.query(function(e){e.page++},kqf.dealer)})}(),function(){$(".sThumb").bind("error",function(){var e=this.src;return/20\//.test(e)?void(this.src=e.replace(/21\//g,"22/")):/22\//.test(e)?void(this.src="./kq/img/no20.png"):void 0})}(),function(){kqf.retab(),$(".TabHead").filter(".active").click(),kqe.search.click()}();